---
title: "biggest_problem"
output: html_document
---

```{r}
# General-purpose data wrangling
library(tidyverse)  

# Parsing of HTML/XML files  
library(rvest)    

# String manipulation
library(stringr)   

# Verbose regular expressions
library(rebus)     

# Eases DateTime manipulation
library(lubridate)
```
```{r}
trim_text <- function(html){
  html %>% 
    # The relevant tag
    #html_nodes('.review-body') %>%      
    html_text() %>% 
    # Trim additional white space
    str_trim() %>%                       
    # Convert the list into a vector
    unlist()                             
}
```


```{r}
'http://biggest.thedickshow.com/wp-content/uploads/2014/05/Maddox_BPU_3.htm'
url_base <- 'http://biggest.thedickshow.com/wp-content/uploads/' 
url_years <- c('2014', '2015')
url_bpu <- 'Maddox_BPU_'
url_ext <- '.htm'
url <- 'http://biggest.thedickshow.com/wp-content/uploads/2014/Maddox_BPU_54.htm'
```

```{r}
html_file <- read_html(url)
html_file
```
```{r}
text_episode <- trim_text(html_file)
```


```{r}
#html_text(html_file)
text_episode_stripped <- gsub('\"', "", str_replace_all(text_episode, "[\r\n]" , ""))
#text_episode_stripped
```
```{r}
speakers <- text_episode_stripped %>% 
  str_match_all("[:alpha:]+:") %>% 
  unlist() %>% 
  unique() %>%
  str_subset("^[:upper:]")
speakers
pattern_speakers <- paste0(speakers, collapse="|")
pattern_speakers
pattern_dialogue <- paste0("\\s+(?=(", pattern_speakers, "))")
pattern_dialogue

str_split(text_episode_stripped, 
          pattern_dialogue) %>% 
  unlist()
```


